package com.mercurio.lms.municipios.action;

import java.util.List;
import java.util.Map;

import com.mercurio.adsm.framework.report.ReportActionSupport;
import com.mercurio.adsm.framework.util.TypedFlatMap;
import com.mercurio.lms.configuracoes.model.MoedaPais;
import com.mercurio.lms.municipios.model.Filial;
import com.mercurio.lms.municipios.model.service.FilialService;
import com.mercurio.lms.municipios.model.service.RotaIdaVoltaService;
import com.mercurio.lms.municipios.report.EmitirRelacaoRotasService;
import com.mercurio.lms.util.session.SessionUtils;

/**
 * Generated by: ADSM ActionGenerator
 *  
 * Não inserir documentação após ou remover a tag do XDoclet a seguir.
 * O valor do <code>id</code> informado abaixo deve ser utilizado para referenciar este serviço.
 * @spring.bean id="lms.municipios.emitirRelacaoRotasAction"
 */

public class EmitirRelacaoRotasAction extends ReportActionSupport {
	
	private RotaIdaVoltaService rotaIdaVoltaService;
	private FilialService filialService;
	private EmitirRelacaoRotasService emitirRelacaoRotasService;
		
	/**
	 * Método responsável por requisitar informações do usuário logado.
	 * @return
	 */
	public TypedFlatMap findInfoUsuarioLogado() {
		Filial f = SessionUtils.getFilialSessao();
		TypedFlatMap retorno = new TypedFlatMap();
		
		retorno.put("filialIntegrante.idFilial",f.getIdFilial());
		retorno.put("filialIntegrante.sgFilial",f.getSgFilial());
		retorno.put("filialIntegrante.pessoa.nmFantasia",f.getPessoa().getNmFantasia());
		
    	MoedaPais moedaPais = filialService.findMoedaPaisByIdFilial(f.getIdFilial());
    	if (moedaPais != null) {
    		retorno.put("moedaPais.idMoedaPais",moedaPais.getIdMoedaPais());    		
    	}
		
		return retorno;
	}
	
	
	public List findLookupRotasViagem(TypedFlatMap tfm) {
		return rotaIdaVoltaService.findLookupRotaIdaVolta(tfm);
	}

    public List findLookupFilial(Map criteria){
    	return getFilialService().findLookup(criteria);
    }

	public FilialService getFilialService() {
		return filialService;
	}

	public void setFilialService(FilialService filialService) {
		this.filialService = filialService;
	}

	public EmitirRelacaoRotasService getEmitirRelacaoRotasService() {
		return emitirRelacaoRotasService;
	}

	public void setEmitirRelacaoRotasService(EmitirRelacaoRotasService emitirRelacaoRotasService) {
		this.reportServiceSupport = emitirRelacaoRotasService;
	}

	public RotaIdaVoltaService getRotaIdaVoltaService() {
		return rotaIdaVoltaService;
	}

	public void setRotaIdaVoltaService(RotaIdaVoltaService rotaIdaVoltaService) {
		this.rotaIdaVoltaService = rotaIdaVoltaService;
	}
}