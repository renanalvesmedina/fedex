package com.mercurio.lms.vendas.action;

import java.util.ArrayList;
import java.util.List;

import com.mercurio.adsm.framework.model.CrudAction;
import com.mercurio.adsm.framework.util.TypedFlatMap;
import com.mercurio.lms.configuracoes.ConfiguracoesFacade;
import com.mercurio.lms.configuracoes.model.Pessoa;
import com.mercurio.lms.vendas.model.Despachante;
import com.mercurio.lms.vendas.model.service.DespachanteService;

import com.mercurio.adsm.framework.annotations.ParametrizedAttribute;

/**
 * Generated by: ADSM ActionGenerator
 *  
 * Não inserir documentação após ou remover a tag do XDoclet a seguir.
 * O valor do <code>id</code> informado abaixo deve ser utilizado para referenciar este serviço.
 * @spring.bean id="lms.vendas.manterDespachantesAction"
 */

public class ManterDespachantesAction extends CrudAction {
	
	private ConfiguracoesFacade configuracoesFacade;
	
	public void setDespachanteService(DespachanteService despachanteService) {
		this.defaultService = despachanteService;
	}
	
	public DespachanteService getDespachanteService() {
		return (DespachanteService)defaultService;		
	}	
	
    public void removeById(java.lang.Long id) {
        ((DespachanteService)defaultService).removeById(id);
    }

	/**
	 *
	 */
	@ParametrizedAttribute(type = java.lang.Long.class)
    public void removeByIds(List ids) {
    	((DespachanteService)defaultService).removeByIds(ids);
    }

    public Despachante findById(java.lang.Long id) {
    	return ((DespachanteService)defaultService).findById(id);
    }
    
    public List findPessoa(TypedFlatMap map){
    	List lstRetorno = new ArrayList();
    	Pessoa pessoa = configuracoesFacade.getPessoa(map.getString("nrIdentificacao"), map.getString("tpIdentificacao"));
    	    	
    	TypedFlatMap mapRetorno = new TypedFlatMap();
    	
    	if (pessoa != null) {
    		
    		getDespachanteService().validateNovoDespachante(pessoa.getIdPessoa());
    		
    		mapRetorno.put("idPessoa", pessoa.getIdPessoa());
    		mapRetorno.put("nmPessoa", pessoa.getNmPessoa());
    		mapRetorno.put("nrIdentificacao", pessoa.getNrIdentificacaoFormatado());
    		mapRetorno.put("tpIdentificacao", pessoa.getTpIdentificacao());
    		mapRetorno.put("tpPessoa", pessoa.getTpPessoa());
    		mapRetorno.put("dsEmail", pessoa.getDsEmail());
    		mapRetorno.put("nrRg", pessoa.getNrRg());
    		mapRetorno.put("dsOrgaoEmissorRg", pessoa.getDsOrgaoEmissorRg());
    		mapRetorno.put("dtEmissaoRg", pessoa.getDtEmissaoRg());
    		
    		lstRetorno.add(mapRetorno);
    	}
    	
    	return lstRetorno;
    }
    
	public void setConfiguracoesFacade(ConfiguracoesFacade configuracoesFacade) {
		this.configuracoesFacade = configuracoesFacade;
	}

}
