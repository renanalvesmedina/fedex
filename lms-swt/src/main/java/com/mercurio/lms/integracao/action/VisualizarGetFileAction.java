package com.mercurio.lms.integracao.action;

import java.util.List;
import java.util.Map;

import com.mercurio.adsm.framework.model.CrudAction;
import com.mercurio.adsm.framework.model.FindDefinition;
import com.mercurio.adsm.framework.model.ResultSetPage;
import com.mercurio.lms.integracao.model.service.GetFileService;
import com.mercurio.lms.util.AliasToNestedMapResultTransformer;
/**
 * Generated by: ADSM ActionGenerator
 *  
 * Não inserir documentação após ou remover a tag do XDoclet a seguir.
 * O valor do <code>id</code> informado abaixo deve ser utilizado para referenciar este serviço.
 * @spring.bean id="lms.integracao.swt.visualizarGetFileAction"
 */
public class VisualizarGetFileAction extends CrudAction {
	
	public ResultSetPage findPaginated(Map criteria) {
		
		FindDefinition findDef = FindDefinition.createFindDefinition(criteria);
		String filial = (String) criteria.get("filial");
		ResultSetPage rsp =  getGetFileService().findPaginated(filial, findDef);
		List<Map> result = AliasToNestedMapResultTransformer.getInstance().transformListResult(rsp.getList());
		if(result != null) {
			for (Map map : result) {
				map.remove("message");
			}
		}
		rsp.setList(result);
		return rsp;
	}
	
	@Override
	public Integer getRowCount(Map criteria) {
		
		String filial = (String) criteria.get("filial");
		criteria.put("_currentPage", "1");
		criteria.put("_pageSize", "999999");
		
		FindDefinition findDef = FindDefinition.createFindDefinition(criteria);
		ResultSetPage rsp =  getGetFileService().findPaginated(filial, findDef);
		return rsp != null && rsp.getList() != null ? rsp.getList().size() : 0;
	}
	
	public GetFileService getGetFileService() {
		return (GetFileService) defaultService;
	}	
	
	public void setGetFileService(GetFileService getFileService) {
		defaultService = getFileService;
	}
}
